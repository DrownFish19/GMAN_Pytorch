K=8, L=5, SE_file='./data/SE(METR).txt', batch_size=16, d=8, decay_epoch=5, learning_rate=0.001, log_file='./data/log', max_epoch=1000, model_file='./data/GMAN.pkl', num_his=12, num_pred=12, patience=10, test_ratio=0.2, time_slot=5, traffic_file='./data/metr-la.h5', train_ratio=0.7, val_ratio=0.1
loading data...
trainX: torch.Size([23967, 12, 207])		 trainY: torch.Size([23967, 12, 207])
valX:   torch.Size([3405, 12, 207])		valY:   torch.Size([3405, 12, 207])
testX:   torch.Size([6831, 12, 207])		testY:   torch.Size([6831, 12, 207])
mean:   54.4039		std:   19.4956
data loaded!
compiling model...
trainable parameters: 817,667
GPU使用情况:3.627008
**** training model ****
2021-07-17 14:35:03 | epoch: 0001/1000, training time: 1155.1s, inference time: 16.8s
train loss: 6.1874, val_loss: 6.2079
val loss decrease from inf to 6.2079, saving model to ./data/GMAN.pkl
2021-07-17 14:54:25 | epoch: 0002/1000, training time: 1145.8s, inference time: 16.8s
train loss: 5.4997, val_loss: 5.6481
val loss decrease from 6.2079 to 5.6481, saving model to ./data/GMAN.pkl
2021-07-17 15:13:45 | epoch: 0003/1000, training time: 1143.1s, inference time: 16.8s
train loss: 5.3096, val_loss: 5.4325
val loss decrease from 5.6481 to 5.4325, saving model to ./data/GMAN.pkl
2021-07-17 15:33:16 | epoch: 0004/1000, training time: 1153.5s, inference time: 16.8s
train loss: 5.1471, val_loss: 4.9999
val loss decrease from 5.4325 to 4.9999, saving model to ./data/GMAN.pkl
2021-07-17 15:52:30 | epoch: 0005/1000, training time: 1137.3s, inference time: 16.8s
train loss: 4.9796, val_loss: 5.2716
2021-07-17 16:12:07 | epoch: 0006/1000, training time: 1159.2s, inference time: 16.8s
train loss: 4.9160, val_loss: 5.2509
2021-07-17 16:31:20 | epoch: 0007/1000, training time: 1136.6s, inference time: 16.8s
train loss: 4.8978, val_loss: 5.1648
2021-07-17 16:50:57 | epoch: 0008/1000, training time: 1160.0s, inference time: 16.8s
train loss: 4.8649, val_loss: 4.9773
val loss decrease from 4.9999 to 4.9773, saving model to ./data/GMAN.pkl
2021-07-17 17:10:25 | epoch: 0009/1000, training time: 1151.1s, inference time: 16.8s
train loss: 4.7885, val_loss: 4.8652
val loss decrease from 4.9773 to 4.8652, saving model to ./data/GMAN.pkl
2021-07-17 17:29:52 | epoch: 0010/1000, training time: 1149.1s, inference time: 16.9s
train loss: 4.7492, val_loss: 7.9539
2021-07-17 17:49:21 | epoch: 0011/1000, training time: 1152.7s, inference time: 16.8s
train loss: 4.6989, val_loss: 4.6955
val loss decrease from 4.8652 to 4.6955, saving model to ./data/GMAN.pkl
2021-07-17 18:08:40 | epoch: 0012/1000, training time: 1141.5s, inference time: 16.8s
train loss: 4.7591, val_loss: 4.8530
2021-07-17 18:27:59 | epoch: 0013/1000, training time: 1142.1s, inference time: 16.7s
train loss: 4.6654, val_loss: 5.4433
2021-07-17 18:47:33 | epoch: 0014/1000, training time: 1156.4s, inference time: 17.0s
train loss: 4.6458, val_loss: 5.0003
2021-07-17 19:06:17 | epoch: 0015/1000, training time: 1107.3s, inference time: 16.7s
train loss: 4.6683, val_loss: 5.1310
2021-07-17 19:22:33 | epoch: 0016/1000, training time: 959.1s, inference time: 16.7s
train loss: 4.5905, val_loss: 4.6504
val loss decrease from 4.6955 to 4.6504, saving model to ./data/GMAN.pkl
2021-07-17 19:39:06 | epoch: 0017/1000, training time: 976.0s, inference time: 16.7s
train loss: 4.4954, val_loss: 4.7905
2021-07-17 19:55:35 | epoch: 0018/1000, training time: 972.0s, inference time: 16.7s
train loss: 4.5223, val_loss: 4.9044
2021-07-17 20:11:53 | epoch: 0019/1000, training time: 961.5s, inference time: 16.7s
train loss: 4.5301, val_loss: 4.7655
2021-07-17 20:28:17 | epoch: 0020/1000, training time: 967.1s, inference time: 16.7s
train loss: 4.4546, val_loss: 4.6663
2021-07-17 20:44:43 | epoch: 0021/1000, training time: 968.5s, inference time: 16.7s
train loss: 4.4039, val_loss: 4.9537
2021-07-17 21:01:20 | epoch: 0022/1000, training time: 980.4s, inference time: 16.7s
train loss: 4.3876, val_loss: 4.7293
2021-07-17 21:17:59 | epoch: 0023/1000, training time: 981.5s, inference time: 16.7s
train loss: 4.4559, val_loss: 4.7805
2021-07-17 21:34:17 | epoch: 0024/1000, training time: 961.4s, inference time: 16.7s
train loss: 4.4359, val_loss: 5.0587
2021-07-17 21:50:55 | epoch: 0025/1000, training time: 980.6s, inference time: 16.7s
train loss: 4.3835, val_loss: 5.2564
2021-07-17 22:07:21 | epoch: 0026/1000, training time: 969.5s, inference time: 16.7s
train loss: 4.2874, val_loss: 4.9337
early stop at epoch: 0026
Training and validation are completed, and model has been stored as ./data/GMAN.pkl
**** testing model ****
loading model from ./data/GMAN.pkl
model restored!
evaluating...
testing time: 33.7s
                MAE		RMSE		MAPE
train            3.31		6.44		7.66%
val              4.93		9.43		9.53%
test             5.39		10.36		10.36%
performance in each prediction step
step: 01         3.80		7.06		7.38%
step: 02         4.17		8.00		8.14%
step: 03         4.50		8.73		8.80%
step: 04         4.80		9.33		9.38%
step: 05         5.12		9.83		9.90%
step: 06         5.40		10.41		10.44%
step: 07         5.67		10.92		10.92%
step: 08         5.91		11.29		11.32%
step: 09         6.11		11.52		11.63%
step: 10         6.27		11.78		11.90%
step: 11         6.40		11.92		12.12%
step: 12         6.56		12.12		12.37%
average:         5.39		10.24		10.36%
total time: 474.8min
